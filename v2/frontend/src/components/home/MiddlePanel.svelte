<script lang="ts">
    import Panel from "../Panel.svelte";
    import Loading from "../Loading.svelte";
    import { fade } from "svelte/transition";
    import { ScreenWidth, screenWidth } from "../../stores/screenWidth";
    import NoChatSelected from "./NoChatSelected.svelte";
    import CurrentChat from "./CurrentChat.svelte";
    import type { ChatMachine } from "../../fsm/chat.machine";
    import type { ActorRefFrom } from "xstate";
    export let machine: ActorRefFrom<ChatMachine> | undefined;
    export let loadingChats: boolean = false;
    export let blocked: boolean;
</script>

<Panel middle>
    {#if loadingChats}
        {#if $screenWidth === ScreenWidth.ExtraSmall}
            <div />
        {:else}
            <Loading />
        {/if}
    {:else if machine === undefined}
        <div class="no-chat" in:fade>
            <NoChatSelected on:newchat />
        </div>
    {:else}
        <CurrentChat
            {blocked}
            {machine}
            on:unblockUser
            on:clearSelection
            on:messageRead
            on:blockUser
            on:leaveGroup
            on:addParticipants
            on:showGroupDetails
            on:showParticipants
            on:chatWith />
    {/if}
</Panel>

<style type="text/scss">
    .no-chat {
        height: 100%;
    }
</style>
