type Delegation = record { pubkey : blob; expiration : nat64 };
type GenerateMagicLinkArgs = record {
    session_key : blob;
    email : text;
    max_time_to_live : opt nat64;
};
type GenerateMagicLinkResponse = variant {
    Blocked : nat64;
    EmailInvalid;
    FailedToSendEmail : text;
    Success : GenerateMagicLinkSuccess;
};
type GenerateMagicLinkSuccess = record {
    created : nat64;
    user_key : blob;
    expiration : nat64;
};
type GetDelegationArgs = record {
    session_key : blob;
    email : text;
    expiration : nat64;
};
type GetDelegationResponse = variant { NotFound; Success : SignedDelegation };
type HandleMagicLinkArgs = record { link : text };
type HandleMagicLinkResponse = variant {
    Success;
    LinkExpired;
    LinkInvalid : text;
};
type SignedDelegation = record { signature : blob; delegation : Delegation };
service : {
    generate_magic_link : (GenerateMagicLinkArgs) -> (GenerateMagicLinkResponse);
    get_delegation : (GetDelegationArgs) -> (GetDelegationResponse) query;
    handle_magic_link : (HandleMagicLinkArgs) -> (HandleMagicLinkResponse);
};
